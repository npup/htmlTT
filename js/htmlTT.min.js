/**
*
* Name: htmlTT.js
* Version: 0.2
* Description: html tooltips
* Author: P. Envall (petter.envall@gmail.com, @npup)
* Date: 2013-08-17
*
*/var htmlTT=function(){function o(a){return"[object Object]"=={}.toString.call(a)}function p(){function a(a){var b=a.getAttribute(d),c;if(!b||!(c=/^(.+)#(.+)$/.exec(b)))return;return{group:c[1],srcId:c[2]}}function c(c){if(h)return;var d=c.target||c.srcElement,e=a(d);if(!e)return;var f=i[e.group],g,j=l[c.type];if(!f||!e.srcId||e.srcId==f.currentSrcId)return;if(!f.modes[j])return;g=b.getElementById(e.srcId);if(!g)return;r(f,d,g,e.srcId)}function e(b){var c=a(b.target||b.srcElement);f(l[b.type],500,b.relatedTarget,c&&c.group)}function f(a,b,c,d){var e=arguments.length>0;for(var f in i){if(d&&f!=d)continue;var g=i[f];if(!g.currentSrcId||e&&!g.modes[a]||c&&(g.view==c||g.view.contains(c)))continue;s(g,b||0)}}m(b.body,"mouseover",c),m(b.body,"mouseout",e),n?(m(b.body,"focusin",c),m(b.body,"focusout",e)):(m(b.body,"focus",c,!0),m(b.body,"blur",e,!0)),m(b,"keyup",function(a){if(27!==a.keyCode)return;h=!0,f(),setTimeout(function(){h=!1},200)}),p=null}function q(a,d){var e=this,f;if(a in i)return;e.modes={hover:!0,focus:!0},"hover"in d&&(e.modes.hover=!!d.hover),"focus"in d&&(e.modes.focus=!!d.focus);if(!e.modes.hover&&!e.modes.focus)return;e.group=a,i[a]=e,e.currentSrcId=null,e.pos={x:0,y:0},e.customView=!1;var g="string"==typeof d["class"]?d["class"]:"";d.view&&("string"==typeof d.view?f=b.getElementById(d.view):1===d.view.nodeType&&(f=d.view)),f?(f.style.visibility="hidden",e.customView=!0):(f=b.createElement("div"),f.className=c,g||(f.style.position="absolute"),f.style.display="none",b.body.appendChild(f)),e.customView||"pos"in d&&!d.pos?e.pos=!1:e.pos&&o(d.pos)&&("x"in d.pos&&(e.pos.x=d.pos.x),"y"in d.pos&&(e.pos.y=d.pos.y)),g&&(f.className+=" "+g),e.view=f,p&&p()}function r(a,b,c,d){a._timeout&&(a._timeout=clearTimeout(a._timeout)),t(a),a.currentSrcId=d,a.view.innerHTML=c.innerHTML,a.pos&&u(a,b),a.view.setAttribute(e,a.group),a.view.setAttribute(f,a.currentSrcId),b.setAttribute(g,a.group),a.currentElem=b,a.customView?a.view.style.visibility="visible":a.view.style.display=""}function s(a,b){a.currentSrcId=null,a._timeout=setTimeout(function(){a.customView?a.view.style.visibility="hidden":a.view.style.display="none",t(a)},b)}function t(a){if(!a.currentElem)return;a.view.removeAttribute(e),a.view.removeAttribute(f),a.currentElem.removeAttribute(g),delete a.currentElem}function u(a,b){var c=b.getBoundingClientRect(),d={top:Math.floor(c.top),left:Math.floor(c.left)},e=v();a.view.style.top=a.pos.y+e.y+d.top+"px",a.view.style.left=a.pos.x+e.x+d.left+"px"}var a=this,b=a.document,c="html-tt",d="data-htmltt",e=d+"-group",f=d+"-src",g=d+"-active",h=!1,i={},j="hover",k="focus",l={mouseover:j,mouseout:j,focusin:k,focusout:k,focus:k,blur:k},m=function(){return"function"==typeof b.body.addEventListener?function(a,b,c,d){a.addEventListener(b,c,!!d)}:function(a,b,c){a.attachEvent("on"+b,c)}}(),n=function(){var a=!1,c=b.createElement("a");return c.href="#",m(c,"focusin",function(){a=!0}),b.body.appendChild(c),c.focus(),b.body.removeChild(c),a}(),v=function(){var c,d;return"undefined"!=typeof a.pageXOffset?function(){return{x:a.pageXOffset,y:a.pageYOffset}}:(d=(c=b.documentElement||b.body.parentNode)&&"number"==typeof c.scrollLeft?c:b.body,function(){return{x:d.scrollLeft,y:d.scrollTop}})}();return{create:function(a,b){return void (new q(a,b||{}))}}}();